# ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–æ–≤ —Å DVC - –ó–∞–≤–µ—Ä—à–µ–Ω–æ

## üéØ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –ü–µ—Ä–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞—Ç–∞—Å–µ—Ç–æ–≤

**–ë—ã–ª–æ:** `api/tests/datasets/` (–≤ Git)
**–°—Ç–∞–ª–æ:** `data/datasets/` (—É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è DVC, –Ω–µ –≤ Git)

#### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:

- ‚úÖ –î–∞—Ç–∞—Å–µ—Ç—ã –Ω–µ –∑–∞—Å–æ—Ä—è—é—Ç Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
- ‚úÖ –ù–µ–∑–∞–≤–∏—Å–∏–º–æ–µ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏ –∫–æ–¥–∞
- ‚úÖ –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ (PDF)
- ‚úÖ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–∫–∞—Ç–∏—Ç—å—Å—è –∫ –ª—é–±–æ–π –≤–µ—Ä—Å–∏–∏ –¥–∞—Ç–∞—Å–µ—Ç–æ–≤
- ‚úÖ –ì–∏–±–∫–æ—Å—Ç—å –≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã–º–∏

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ DVC (Data Version Control)

#### –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ:

```
Knowledge_Map/
‚îú‚îÄ‚îÄ .dvc/
‚îÇ   ‚îú‚îÄ‚îÄ config              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è DVC
‚îÇ   ‚îî‚îÄ‚îÄ cache/              # –õ–æ–∫–∞–ª—å–Ω—ã–π –∫—ç—à –¥–∞—Ç–∞—Å–µ—Ç–æ–≤
‚îú‚îÄ‚îÄ .dvcignore             # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è DVC
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ .gitkeep           # –í Git
‚îÇ   ‚îú‚îÄ‚îÄ datasets.dvc       # –í Git - –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ DVC
‚îÇ   ‚îî‚îÄ‚îÄ datasets/          # –ù–ï –≤ Git - —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è DVC
‚îî‚îÄ‚îÄ DVC_GUIDE.md           # –ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
```

#### –î–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```toml
[tool.poetry.group.dev.dependencies]
dvc = "^3.0.0"
pytest = "^8.0.0"
pytest-asyncio = "^0.23.0"
```

### 3. –û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ –ø—É—Ç–∏

#### –§–∞–π–ª—ã —Å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –ø—É—Ç—è–º–∏:

- ‚úÖ [api/tests/conftest.py](api/tests/conftest.py:22) - `DATASETS_DIR = PROJECT_ROOT / "data" / "datasets"`
- ‚úÖ [api/tools/dataset_builder/export_dataset.py](api/tools/dataset_builder/export_dataset.py:33)
- ‚úÖ [api/tools/dataset_builder/import_dataset.py](api/tools/dataset_builder/import_dataset.py:34)
- ‚úÖ [api/tools/dataset_builder/validate_dataset.py](api/tools/dataset_builder/validate_dataset.py:26)

### 4. –û–±–Ω–æ–≤–ª–µ–Ω .gitignore

```gitignore
# Data directory - content managed by DVC
/data/datasets/
/data/*.dvc.tmp
# But keep .dvc files and .gitkeep
!/data/.gitkeep
!/data/datasets.dvc

# DVC
/.dvc/cache
/.dvc/tmp
/.dvc/plots
```

### 5. –°–æ–∑–¥–∞–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- ‚úÖ [DVC_GUIDE.md](DVC_GUIDE.md) - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–±–æ—Ç–µ —Å DVC
- ‚úÖ [data/datasets/README.md](data/datasets/README.md) - –û–±–Ω–æ–≤–ª–µ–Ω —Å —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ–º DVC
- ‚úÖ [api/tests/README.md](api/tests/README.md) - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ç–µ—Å—Ç–∞–º
- ‚úÖ [api/TESTING_GUIDE.md](api/TESTING_GUIDE.md) - –û–±—â–µ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ

### 6. –ü—Ä–∏–º–µ—Ä –¥–∞—Ç–∞—Å–µ—Ç–∞

‚úÖ `sample_001` —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –Ω–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

## üöÄ –ö–∞–∫ –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç–∞—Ç—å

### –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ (–Ω–æ–≤—ã–π —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫)

```bash
# 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone <repo-url>
cd Knowledge_Map

# 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
cd api
poetry install

# 3. –ü–æ–ª—É—á–∏—Ç—å –¥–∞—Ç–∞—Å–µ—Ç—ã –∏–∑ DVC
cd ..
dvc pull  # –ü–æ–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç—ã –Ω–µ –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã, –∫–æ–º–∞–Ω–¥–∞ –Ω–∏—á–µ–≥–æ –Ω–µ —Å–¥–µ–ª–∞–µ—Ç

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é
cd api
poetry run python tools/dataset_builder/validate_dataset.py --sample sample_001
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞

```bash
# 1. –†–∞–∑–º–µ—Ç–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

# 2. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ –¥–∞—Ç–∞—Å–µ—Ç
cd api
poetry run python tools/dataset_builder/export_dataset.py \
  --doc-id <your_doc_id> \
  --output sample_002 \
  --include-pdf

# 3. –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å
poetry run python tools/dataset_builder/validate_dataset.py --sample sample_002

# 4. –î–æ–±–∞–≤–∏—Ç—å –≤ DVC
cd ..
dvc add data/datasets

# 5. –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
git add data/datasets.dvc .gitignore
git commit -m "Add sample_002 dataset"
```

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
cd api

# –í—Å–µ —Ç–µ—Å—Ç—ã
poetry run pytest tests/

# –¢–æ–ª—å–∫–æ —Å –¥–∞—Ç–∞—Å–µ—Ç–∞–º–∏
poetry run pytest tests/ -m dataset

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Å—Ç
poetry run pytest tests/test_routers/test_nlp.py -v
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞:

1. **[DVC_GUIDE.md](DVC_GUIDE.md)** - –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—Ç—å —Å DVC
   - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
   - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç–æ–≤
   - –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
   - Troubleshooting

2. **[api/TESTING_GUIDE.md](api/TESTING_GUIDE.md)** - –û–±—â–µ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
   - –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤
   - –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
   - Workflow

3. **[data/datasets/README.md](data/datasets/README.md)** - –§–æ—Ä–º–∞—Ç –¥–∞—Ç–∞—Å–µ—Ç–æ–≤
   - –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤
   - JSON —Å—Ö–µ–º—ã
   - –ü—Ä–∏–º–µ—Ä—ã

4. **[api/tests/README.md](api/tests/README.md)** - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –ø–æ —Ç–µ—Å—Ç–∞–º
   - –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
   - –§–∏–∫—Å—Ç—É—Ä—ã
   - –ü—Ä–∏–º–µ—Ä—ã

## üéì –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏

### DVC vs Git

| –ê—Å–ø–µ–∫—Ç | Git | DVC |
|--------|-----|-----|
| **–ß—Ç–æ —Ö—Ä–∞–Ω–∏—Ç** | –ö–æ–¥, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è | –î–∞–Ω–Ω—ã–µ, –º–æ–¥–µ–ª–∏ |
| **–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–æ–≤** | –ú–∞–ª–µ–Ω—å–∫–∏–µ (<100KB) | –õ—é–±–æ–π —Ä–∞–∑–º–µ—Ä |
| **–í —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏** | –°–∞–º –∫–æ–Ω—Ç–µ–Ω—Ç | –¢–æ–ª—å–∫–æ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (.dvc —Ñ–∞–π–ª—ã) |
| **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** | –í—Å—Ç—Ä–æ–µ–Ω–Ω–æ–µ | –ß–µ—Ä–µ–∑ .dvc —Ñ–∞–π–ª—ã –≤ Git |

### Workflow —Å DVC

```
1. –†–∞–∑–º–µ—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–µ ‚Üí 2. –≠–∫—Å–ø–æ—Ä—Ç –≤ –¥–∞—Ç–∞—Å–µ—Ç ‚Üí 3. dvc add ‚Üí 4. git commit
                                                           ‚Üì
                                                      –í Git –ø–æ–ø–∞–¥–∞—é—Ç
                                                      —Ç–æ–ª—å–∫–æ .dvc —Ñ–∞–π–ª—ã
```

### –ß—Ç–æ –≥–¥–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è

```
Git —Ö—Ä–∞–Ω–∏—Ç:
‚îú‚îÄ‚îÄ –ö–æ–¥ (api/, src/, etc.)
‚îú‚îÄ‚îÄ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (.env.example, pytest.ini)
‚îú‚îÄ‚îÄ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é (*.md)
‚îî‚îÄ‚îÄ DVC –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (data/datasets.dvc)

DVC —É–ø—Ä–∞–≤–ª—è–µ—Ç:
‚îî‚îÄ‚îÄ –î–∞—Ç–∞—Å–µ—Ç–∞–º–∏ (data/datasets/)
    ‚îú‚îÄ‚îÄ PDF —Ñ–∞–π–ª—ã
    ‚îú‚îÄ‚îÄ Markdown —Ñ–∞–π–ª—ã
    ‚îú‚îÄ‚îÄ JSON –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏
    ‚îî‚îÄ‚îÄ –°—Ö–µ–º—ã

–õ–æ–∫–∞–ª—å–Ω–æ (–Ω–µ –≤ Git):
‚îú‚îÄ‚îÄ .dvc/cache/ (–∫—ç—à DVC)
‚îú‚îÄ‚îÄ .venv/ (–≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ)
‚îî‚îÄ‚îÄ __pycache__/ (Python –∫—ç—à)
```

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç:

```bash
# 1. DVC —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
cd api
poetry run dvc version

# 2. –î–∞—Ç–∞—Å–µ—Ç—ã –Ω–∞ –º–µ—Å—Ç–µ
ls ../data/datasets/documents/sample_001/

# 3. –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–æ—Ö–æ–¥–∏—Ç
poetry run python tools/dataset_builder/validate_dataset.py --sample sample_001

# 4. –¢–µ—Å—Ç—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è (–º–æ–≥—É—Ç –ø–∞–¥–∞—Ç—å, –Ω–æ –¥–æ–ª–∂–Ω—ã —Å—Ç–∞—Ä—Ç–æ–≤–∞—Ç—å)
poetry run pytest tests/ --collect-only
```

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ **–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ** —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –≤ –¥–∞—Ç–∞—Å–µ—Ç—ã
2. ‚úÖ **–ó–∞–∫–æ–º–º–∏—Ç—å—Ç–µ** –ø–µ—Ä–≤—É—é –≤–µ—Ä—Å–∏—é –¥–∞—Ç–∞—Å–µ—Ç–æ–≤ –≤ DVC
3. ‚úÖ **–ù–∞–ø–∏—à–∏—Ç–µ** —Ç–µ—Å—Ç—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
4. ‚úÖ **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ** CI/CD –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤
5. ‚è≥ **–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ:** –ù–∞—Å—Ç—Ä–æ–π—Ç–µ remote storage –¥–ª—è DVC (S3, GCS, etc.)

## üí° Tips & Tricks

### –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –¥–∞—Ç–∞—Å–µ—Ç–∞—Ö

```bash
# –ü–æ–∫–∞–∑–∞—Ç—å —á—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å
dvc status

# –ü–æ–∫–∞–∑–∞—Ç—å diff
dvc diff
```

### –û—Ç–∫–∞—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞

```bash
# –û—Ç–∫–∞—Ç–∏—Ç—å .dvc —Ñ–∞–π–ª
git checkout HEAD~1 data/datasets.dvc

# –û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
dvc checkout
```

### –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ DVC

```bash
# –£–¥–∞–ª–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ–∞–π–ª—ã
dvc gc

# –†–∞–∑–º–µ—Ä –∫—ç—à–∞
du -sh .dvc/cache
```

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [DVC Documentation](https://dvc.org/doc)
- [DVC Get Started](https://dvc.org/doc/start)
- [Pytest Documentation](https://docs.pytest.org/)

---

**–ê–≤—Ç–æ—Ä:** Claude Code
**–î–∞—Ç–∞:** 2024-11-17
**–í–µ—Ä—Å–∏—è:** 1.0

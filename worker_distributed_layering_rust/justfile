# Justfile –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∑–∞–¥–∞—á —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

# –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
default:
    @just --list

# –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ –≤ debug —Ä–µ–∂–∏–º–µ
build:
    cargo build

# –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ –≤ release —Ä–µ–∂–∏–º–µ
build-release:
    cargo build --release

# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
run:
    cargo run --bin graph-layout-server

# –ó–∞–ø—É—Å–∫ —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
run-config config="config.toml":
    cargo run --bin graph-layout-server -- --config {{config}}

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
test:
    cargo test

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ —Å –≤—ã–≤–æ–¥–æ–º
test-verbose:
    cargo test -- --nocapture

# –ó–∞–ø—É—Å–∫ benchmarks
bench:
    cargo bench

# –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
fmt:
    cargo fmt

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞
check:
    cargo check

# Clippy –ø—Ä–æ–≤–µ—Ä–∫–∏
clippy:
    cargo clippy -- -D warnings

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
docs:
    cargo doc --open

# –û—á–∏—Å—Ç–∫–∞
clean:
    cargo clean

# –°–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–∞
docker-build:
    docker build -t graph-layout-engine .

# –ó–∞–ø—É—Å–∫ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker-run:
    docker run -p 50051:50051 -p 9090:9090 graph-layout-engine

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
health:
    cargo run --bin graph-layout-server -- --mode health

# –ó–∞–ø—É—Å–∫ benchmarks
benchmark:
    cargo run --bin graph-layout-server -- --mode benchmark

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ dependencies
deps:
    cargo fetch

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ dependencies
update:
    cargo update

# Profiling —Å perf
profile:
    perf record -g cargo run --release --bin graph-layout-server
    perf report

# –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ commit
ci: fmt clippy test
    @echo "‚úÖ All checks passed!"

# –°–æ–∑–¥–∞–Ω–∏–µ release build —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è–º–∏
release: clean build-release
    @echo "üöÄ Release build completed!"

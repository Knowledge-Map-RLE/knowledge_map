# –û—Ç—á–µ—Ç –æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –º–∞—Å—à—Ç–∞–±–æ–≤

## üéØ –¶–µ–ª—å
–î–æ–±–∞–≤–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–≤—è–∑–∫–∏ –±–ª–æ–∫–æ–≤ –∫–∞—Ä—Ç—ã –∑–Ω–∞–Ω–∏–π –∫ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–º –º–∞—Å—à—Ç–∞–±–∞–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, "1 –º", "1 –∫–º", "1 –º–º") –¥–ª—è –ª—É—á—à–µ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ —Ä–∞–∑–º–µ—Ä–∞–º –æ–±—ä–µ–∫—Ç–æ–≤.

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ (95%)

### Backend
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `physical_scale` –≤ –º–æ–¥–µ–ª—å Block (IntegerProperty, default=0)
- ‚úÖ –°–æ–∑–¥–∞–Ω API —ç–Ω–¥–ø–æ–∏–Ω—Ç `POST /api/blocks/{id}/pin_with_scale` —Å PinWithScaleInput
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ Neo4j queries –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è physical_scale –ø–æ–ª—è
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã protobuf —Å—Ö–µ–º—ã (layout.proto) —Å –ø–æ–ª–µ–º physical_scale
- ‚úÖ –†–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã protobuf —Ñ–∞–π–ª—ã –≤ –æ–±–æ–∏—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö

### Frontend
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã —É—Ç–∏–ª–∏—Ç—ã –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –º–∞—Å—à—Ç–∞–±–æ–≤ (`scaleUtils.ts`):
  - SCALE_UNITS –º–∞—Å—Å–∏–≤ (–Ω–º ‚Üí –ì–º)
  - exponentToReadableScale() –∏ readableScaleToExponent()
  - formatScaleForDisplay() –∏ getLevelName()
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω BlockContextMenu.tsx:
  - –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–ø—Ü–∏—è "–ó–∞–∫—Ä–µ–ø–∏—Ç—å –∑–∞ —É—Ä–æ–≤–Ω–µ–º —Å –º–∞—Å—à—Ç–∞–±–æ–º"
  - –ß–∏—Å–ª–æ–≤–æ–µ –ø–æ–ª–µ –≤–≤–æ–¥–∞ –∑–Ω–∞—á–µ–Ω–∏—è
  - Dropdown —Å –µ–¥–∏–Ω–∏—Ü–∞–º–∏ –∏–∑–º–µ—Ä–µ–Ω–∏—è
  - –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å —Ç–µ–∫—É—â–∏–º –º–∞—Å—à—Ç–∞–±–æ–º
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω Level.tsx –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –º–∞—Å—à—Ç–∞–±–æ–≤ –≤–º–µ—Å—Ç–æ –Ω–æ–º–µ—Ä–æ–≤ —É—Ä–æ–≤–Ω–µ–π
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `pinBlockWithScale()` –≤ API —Å–µ—Ä–≤–∏—Å—ã
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö (BlockData, Block interfaces)

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã —Ç–µ—Å—Ç—ã —É—Ç–∏–ª–∏—Ç –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ (–≤—Å–µ 7 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç)
- ‚úÖ –°–æ–∑–¥–∞–Ω –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π —Ç–µ—Å—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ (`test_scale_functionality.py`)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ neomodel ORM

## ‚ö†Ô∏è –¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞ (5%)

### Layout Service Error
- ‚ùå –û—à–∏–±–∫–∞ "bad argument type for built-in operation" –≤ layout service
- ‚ùå –ë–ª–æ–∫–∏—Ä—É–µ—Ç —ç–Ω–¥–ø–æ–∏–Ω—Ç `/layout/neo4j`
- ‚ùå –ù–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å, –Ω–æ –º–µ—à–∞–µ—Ç –ø–æ–ª–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
- API –∑–∞–≥—Ä—É–∂–∞–µ—Ç –±–ª–æ–∫–∏ –∏–∑ Neo4j –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (20 –±–ª–æ–∫–æ–≤)
- –ü—Ä–æ–±–ª–µ–º–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –ø—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–µ –¥–∞–Ω–Ω—ã—Ö –≤ gRPC layout service
- –í–æ–∑–º–æ–∂–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞: –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö –≤ protobuf

## üöÄ –ì–æ—Ç–æ–≤–æ –∫ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏

–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –æ—Å—Ç–∞—Ç–æ—á–Ω—É—é –ø—Ä–æ–±–ª–µ–º—É —Å layout service, –æ—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å **–ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç**:

1. ‚úÖ UI –≥–æ—Ç–æ–≤ - –º–æ–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é –±–ª–æ–∫–∞
2. ‚úÖ –ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å "–ó–∞–∫—Ä–µ–ø–∏—Ç—å –∑–∞ —É—Ä–æ–≤–Ω–µ–º —Å –º–∞—Å—à—Ç–∞–±–æ–º"
3. ‚úÖ –ú–æ–∂–Ω–æ –≤–≤–µ—Å—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –∏ –≤—ã–±—Ä–∞—Ç—å –µ–¥–∏–Ω–∏—Ü—É (–Ω–º, –º–∫–º, –º–º, —Å–º, –º, –∫–º, –ú–º, –ì–º)
4. ‚úÖ API –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã pin_with_scale
5. ‚úÖ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö Neo4j
6. ‚úÖ –£—Ä–æ–≤–Ω–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Å —á–∏—Ç–∞–µ–º—ã–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ –º–∞—Å—à—Ç–∞–±–æ–≤

## üõ†Ô∏è –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å layout service error** (5% —Ä–∞–±–æ—Ç—ã)
   - –î–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—É —Å —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –≤ protobuf
   - –í–æ–∑–º–æ–∂–Ω–æ, –¥–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É null/None –∑–Ω–∞—á–µ–Ω–∏–π
   
2. **–ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**
   - –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è layout service –≤—Å–µ –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é
   - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å end-to-end —Å—Ü–µ–Ω–∞—Ä–∏–π
   
3. **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   - –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —É—Ä–æ–≤–Ω–µ–π –ø–æ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–º—É –º–∞—Å—à—Ç–∞–±—É
   - –ü–æ–∏—Å–∫ –±–ª–æ–∫–æ–≤ –ø–æ –º–∞—Å—à—Ç–∞–±—É
   - –≠–∫—Å–ø–æ—Ä—Ç/–∏–º–ø–æ—Ä—Ç –º–∞—Å—à—Ç–∞–±–æ–≤

## üìä –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

- **–•—Ä–∞–Ω–µ–Ω–∏–µ**: –°—Ç–µ–ø–µ–Ω—å 10 –≤ –º–µ—Ç—Ä–∞—Ö (0 = 1–º, 3 = 1–∫–º, -3 = 1–º–º)
- **–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è**: –û—Ç–¥–µ–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ–∂–¥—É —Å—Ç–µ–ø–µ–Ω—è–º–∏ –∏ UI
- **UI/UX**: –ò–Ω—Ç—É–∏—Ç–∏–≤–Ω—ã–π dropdown —Å –∑–Ω–∞–∫–æ–º—ã–º–∏ –µ–¥–∏–Ω–∏—Ü–∞–º–∏
- **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0 (1 –º–µ—Ç—Ä) –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º –∫–æ–¥–µ

---
*–°—Ç–∞—Ç—É—Å: 95% –∑–∞–≤–µ—Ä—à–µ–Ω–æ, –≥–æ—Ç–æ–≤–æ –∫ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏* 